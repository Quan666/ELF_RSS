# 2.0 使用教程

> 注意：
>
> 1. 所有命令均分群组、子频道和私聊三种情况，执行结果也会不同
> 2. [] 包起来的参数表示可选，但某些情况下为必须参数
> 3. 所有订阅命令群管都可使用（但是有一定限制）
> 4. 私聊直接发送命令即可，群聊和子频道需在消息首部或尾部添加 **机器人昵称** 或者 **@机器人**
> 5. 群聊中也可以回复机器人发的消息执行命令，子频道暂不支持
> 6. 所有参数之间均用空格分割，符号为英文标点

## 添加订阅

> 命令：add （添加订阅、sub）
>
> 参数：订阅名 [RSS 地址]
>
> 示例： `add test twitter/user/huagequan`
>
> 使用技巧：先快速添加订阅，之后再通过 `change` 命令修改
>
> 命令解释：
>
> 必需 `订阅名` 及 `RSS地址（RSSHub订阅源可以省略域名，其余需要完整的URL地址）` 两个参数，
> 订阅到当前 `群组` 、 `频道` 或 `QQ`。

## 添加 RSSHub 订阅

> 命令：rsshub_add
>
> 参数：[RSSHub 路由名] [订阅名]
>
> 示例： `rsshub_add github`
>
> 命令解释：
>
> 发送命令后，按照提示依次输入 RSSHub 路由、订阅名和路由参数

## 删除订阅

> 命令：deldy （删除订阅、drop、unsub）
>
> 参数：订阅名 [订阅名 ...]（支持批量操作）
>
> 示例： `deldy test` `deldy test1 test2`
>
> 命令解释：
>
> 1. 在超级管理员私聊使用该命令时，可完全删除订阅
> 2. 在群组使用该命令时，将该群组从订阅群组中删除
> 3. 在子频道使用该命令时，将该子频道从订阅子频道中删除

## 所有订阅

> 命令：show_all（showall，select_all，selectall，所有订阅）
>
> 参数：[关键词]（支持正则，过滤生效范围：订阅名、订阅地址、QQ 号、群号）
>
> 示例： `showall test` `showall 123`
>
> 命令解释：
>
> 1. 携带 `关键词` 参数时，展示该群组或子频道或所有订阅中含有关键词的订阅
> 2. 不携带 `关键词` 参数时，展示该群组或子频道或所有订阅
> 3. 当 `关键词` 参数为整数时候，只对超级管理员用户额外展示所有订阅中 `QQ号` 或 `群号` 含有关键词的订阅

## 查看订阅

> 命令：show（查看订阅）
>
> 参数：[订阅名]
>
> 示例： `show test`
>
> 命令解释：
>
> 1. 携带 `订阅名` 参数时，展示该订阅的详细信息
> 2. 不携带 `订阅名` 参数时，展示该群组或子频道或 QQ 的订阅详情

## 修改订阅

> 命令：change（修改订阅，moddy）
>
> 参数：订阅名[, 订阅名,...] 属性=值[ 属性=值 ...]
>
> 示例： `change test1[,test2,...] qq=,123,234 qun=-1`
>
> 使用技巧：可以先只发送 `change` ，机器人会返回提示信息，无需记住复杂的参数列表
>
> 对应参数:
>
> | 修改项             | 参数名       | 值范围                            | 备注                                                                                                                                               |
> |-----------------|-----------|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
> | 订阅名             | -name     | 无空格字符串                         | 禁止将多个订阅批量改名，会因为名称相同起冲突                                                                                                                           |
> | 订阅链接            | -url      | 无空格字符串                         | RSSHub 订阅源可以省略域名，其余需要完整的 URL 地址                                                                                                                  |
> | QQ 号            | -qq       | 正整数 / -1                       | 需要先加该对象好友；前加英文逗号表示追加；-1 设为空                                                                                                                      |
> | QQ 群            | -qun      | 正整数 / -1                       | 需要先加入该群组；前加英文逗号表示追加；-1 设为空                                                                                                                       |
> | 更新频率            | -time     | 正整数 / crontab 字符串              | 值为整数时表示每 x 分钟进行一次检查更新，且必须大于等于 1<br />值为 crontab 字符串时，详见表格下方的补充说明                                                                                 |
> | 代理              | -proxy    | 1 / 0                          | 是否启用代理                                                                                                                                           |
> | 翻译              | -tl       | 1 / 0                          | 是否翻译正文内容                                                                                                                                         |
> | 仅标题             | -ot       | 1 / 0                          | 是否仅发送标题                                                                                                                                          |
> | 仅图片             | -op       | 1 / 0                          | 是否仅发送图片 (正文中只保留图片)                                                                                                                               |
> | 仅含有图片           | -ohp      | 1 / 0                          | 仅含有图片不同于仅图片，除了图片还会发送正文中的其他文本信息                                                                                                                   |
> | 下载种子            | -downopen | 1 / 0                          | 是否进行 BT 下载 (需要配置 qBittorrent，参考：[第一次部署](部署教程.md#第一次部署))                                                                                          |
> | 白名单关键词          | -wkey     | 无空格字符串 / 空                     | 支持正则表达式，匹配时推送消息及下载<br />设为空 (wkey=) 时不生效<br />前面加 +/- 表示追加/去除，详见表格下方的补充说明                                                                        |
> | 黑名单关键词          | -bkey     | 无空格字符串 / 空                     | 同白名单关键词，但匹配时不推送，可在避免冲突的情况下组合使用                                                                                                                   |
> | 种子上传到群          | -upgroup  | 1 / 0                          | 是否将 BT 下载完成的文件上传到群 (需要配置 qBittorrent，参考：[第一次部署](部署教程.md#第一次部署))                                                                                  |
> | 去重模式            | -mode     | link / title / image / or / -1 | 分为按链接 (link)、标题 (title)、图片 (image) 判断<br />其中 image 模式，出于性能考虑以及避免误伤情况发生，生效对象限定为只带 1 张图片的消息<br />此外，如果属性中带有 or 说明判断逻辑是任一匹配即去重，默认为全匹配<br />-1 设为禁用 |
> | 图片数量限制          | -img_num  | 正整数                            | 只发送限定数量的图片，防止刷屏                                                                                                                                  |
> | 正文待移除内容         | -rm_list  | 无空格字符串 / -1                    | 从正文中要移除的指定内容，支持正则表达式<br />因为参数解析的缘故，格式必须如：`rm_list='a'` 或 `rm_list='a','b'` <br />该处理过程是在解析 html 标签后进行的<br />要将该参数设为空，使用 `rm_list='-1'`          |
> | 停止更新            | -stop     | 1 / 0                          | 对订阅停止、恢复检查更新                                                                                                                                     |
> | PikPak 离线下载     | -pikpak   | 1 / 0                          | 将磁力链接离线到 PikPak 网盘，方便追番                                                                                                                          |
> | PikPak 离线下载路径匹配 | -ppk      | 无空格字符串                         | 匹配正文中的关键字作为目录                                                                                                                                    |
> | 发送合并消息          | -forward  | 1 / 0                          | 当一次更新多条消息时，尝试发送合并消息                                                                                                                              |
> 
> **注：**
>
> 各个属性之间使用**空格**分割
>
> wkey / bkey 前面加 +/- 表示追加/去除，最终处理为格式如 `a` 、 `a|b` 、 `a|b|c` …… 
>
> 如要使用，请在修改后检查处理后的正则表达式是否正确
>
> time 属性兼容 Linux crontab 格式，**但不同的是，crontab 中的空格应该替换为 `_` 即下划线**
>
> 可以参考 [Linux crontab 命令](https://www.runoob.com/linux/linux-comm-crontab.html) 务必理解！但实际有少许不同，主要是设置第 5 个字段时，即每周有不同。
>
> 时间格式如下：
>
> ```text
> f1_f2_f3_f4_f5
> ```
>
> - 其中 f1 是表示分钟，f2 表示小时，f3 表示一个月份中的第几日，f4 表示月份，f5 表示一个星期中的第几天。program 表示要执行的程序。
> - 当 f1 为 *时表示每分钟都要执行 program，f2 为* 时表示每小时都要执行程序，其馀类推
> - 当 f1 为 a-b 时表示从第 a 分钟到第 b 分钟这段时间内要执行，f2 为 a-b 时表示从第 a 到第 b 小时都要执行，其馀类推
> - 当 f1 为 */n 时表示每 n 分钟个时间间隔执行一次，f2 为*/n 表示每 n 小时个时间间隔执行一次，其馀类推
> - 当 f1 为 a, b, c, ... 时表示第 a, b, c, ... 分钟要执行，f2 为 a, b, c, ... 时表示第 a, b, c... 个小时要执行，其馀类推
>
> ```text
> *    *    *    *    *
> -    -    -    -    -
> |    |    |    |    |
> |    |    |    |    +----- 星期中星期几 (0 - 6) (星期一为 0，星期天为 6) (int|str) – number or name of weekday (0-6 or mon,tue,wed,thu,fri,sat,sun)
> |    |    |    +---------- 月份 (1 - 12)
> |    |    +--------------- 一个月中的第几天 (1 - 31)
> |    +-------------------- 小时 (0 - 23)
> +------------------------- 分钟 (0 - 59)
> ```
>
> 以下是一些示例：
>
> ``` text
> 1            # 每分钟执行一次（普通）
> 1_           # 每小时的第一分钟运行（cron）
> */1          # 每分钟执行一次
> *_*/1        # 每小时执行一次（注意，均在整点运行）
> *_*_*_*_0, 1, 2, 6 # 每周 1、2、3、日运行，周日为 6
> 0_6-12/3_*_12_* #在 12 月内, 每天的早上 6 点到 12 点，每隔 3 个小时 0 分钟执行一次
> *_12_*          # 每天 12 点运行
> # 如果不生效请查看控制台输出
> ```
